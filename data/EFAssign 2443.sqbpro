<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="EFAssign 2443.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="1"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="47790"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="0" parent="2"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><table title="classes_view" custom_title="0" dock_id="8" table="4,12:mainclasses_view"/><table title="programs" custom_title="0" dock_id="7" table="4,8:mainprograms"/><table title="classes_view" custom_title="0" dock_id="6" table="4,12:mainclasses_view"/><table title="timeslots" custom_title="0" dock_id="5" table="4,9:maintimeslots"/><table title="assignments" custom_title="0" dock_id="11" table="4,11:mainassignments"/><table title="classes_view" custom_title="0" dock_id="10" table="4,12:mainclasses_view"/><table title="rooms" custom_title="0" dock_id="9" table="4,5:mainrooms"/><table title="demand_view" custom_title="0" dock_id="4" table="4,11:maindemand_view"/><dock_state state="000000ff00000000fd0000000100000002000008a700000573fc0100000003fb000000160064006f0063006b00420072006f00770073006500310100000000000007580000000000000000fc00000000000007580000000000fffffffa000000000100000002fb000000160064006f0063006b00420072006f00770073006500320100000000ffffffff0000000000000000fb000000160064006f0063006b00420072006f00770073006500330100000000ffffffff0000000000000000fc00000000000008a7000001c600fffffffa000000020100000008fb000000160064006f0063006b00420072006f00770073006500340100000000ffffffff000001c600fffffffb000000160064006f0063006b00420072006f00770073006500350100000000ffffffff000001c600fffffffb000000160064006f0063006b00420072006f00770073006500360100000000ffffffff000001c600fffffffb000000160064006f0063006b00420072006f00770073006500370100000000ffffffff000001c600fffffffb000000160064006f0063006b00420072006f00770073006500380100000000ffffffff000001c600fffffffb000000160064006f0063006b00420072006f00770073006500390100000000ffffffff000001c600fffffffb000000180064006f0063006b00420072006f007700730065003100300100000000ffffffff000001c600fffffffb000000180064006f0063006b00420072006f007700730065003100310100000000ffffffff000001c600ffffff000008a70000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="assignments" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="467"/><column index="2" value="380"/><column index="3" value="541"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="choices" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="71"/><column index="2" value="59"/><column index="3" value="92"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="classes" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="300"/><column index="2" value="243"/><column index="3" value="300"/><column index="4" value="87"/><column index="5" value="300"/><column index="6" value="300"/><column index="7" value="127"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="classes_view" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="300"/><column index="2" value="110"/><column index="3" value="243"/><column index="4" value="127"/><column index="5" value="69"/><column index="6" value="185"/><column index="7" value="92"/><column index="8" value="113"/><column index="9" value="225"/><column index="10" value="300"/><column index="11" value="154"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="demand_by_course_view" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="110"/><column index="2" value="49"/><column index="3" value="49"/><column index="4" value="49"/><column index="5" value="49"/><column index="6" value="49"/><column index="7" value="49"/><column index="8" value="49"/><column index="9" value="49"/><column index="10" value="43"/><column index="11" value="46"/><column index="12" value="47"/><column index="13" value="47"/><column index="14" value="47"/><column index="15" value="55"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="demand_by_level_view" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="110"/><column index="2" value="176"/><column index="3" value="41"/><column index="4" value="44"/><column index="5" value="44"/><column index="6" value="35"/><column index="7" value="37"/><column index="8" value="38"/><column index="9" value="38"/><column index="10" value="38"/><column index="11" value="43"/><column index="12" value="46"/><column index="13" value="47"/><column index="14" value="47"/><column index="15" value="47"/><column index="16" value="55"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="demand_view" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="300"/><column index="2" value="300"/><column index="3" value="235"/><column index="4" value="300"/><column index="5" value="176"/><column index="6" value="101"/><column index="7" value="110"/><column index="8" value="110"/><column index="9" value="110"/><column index="10" value="107"/><column index="11" value="107"/><column index="12" value="107"/><column index="13" value="107"/><column index="14" value="107"/><column index="15" value="107"/><column index="16" value="107"/><column index="17" value="107"/><column index="18" value="107"/><column index="19" value="107"/><column index="20" value="65"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="programs" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="101"/><column index="2" value="59"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="rooms" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="300"/><column index="2" value="258"/><column index="3" value="199"/><column index="4" value="89"/><column index="5" value="65"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="students" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="300"/><column index="2" value="300"/><column index="3" value="235"/><column index="4" value="300"/><column index="5" value="176"/><column index="6" value="101"/><column index="7" value="220"/><column index="8" value="65"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="teacherpreferences" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="300"/><column index="2" value="300"/><column index="3" value="64"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="teachers" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="300"/><column index="2" value="225"/><column index="3" value="290"/><column index="4" value="297"/><column index="5" value="95"/><column index="6" value="65"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="timeslots" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="300"/><column index="2" value="92"/><column index="3" value="107"/><column index="4" value="97"/><column index="5" value="65"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1*">SELECT c.title, ts.weekday, c.class_id FROM classes c
JOIN timeslots ts USING (timeslot_id)
WHERE ts.active = 1 AND ts.weekday IN (&quot;Wed&quot;)
ORDER BY ts.weekday, c.title</sql><sql name="Edit View classes_view*">DROP VIEW IF EXISTS &quot;main&quot;.&quot;classes_view&quot;;
CREATE VIEW classes_view as 
SELECT class_id, c.code as 'course', 
cls.title as 'class', 
r.name as 'where', 
w.sort_key as weekday_sort_key, 
ts.weekday as weekday,
 ts.weekday || ' ' || timeslots.start_time as 'when', 
 t.name as 'who',
 ts.timeslot_id as timeslot_id,
 ts.active as timeslot_active
 FROM classes cls
	LEFT JOIN courses c USING (course_id)
	LEFT JOIN rooms r USING (room_id)
	LEFT JOIN timeslots ts USING (timeslot_id)
	LEFT JOIN teachers t USING (teacher_id)
	LEFT JOIN weekdays w ON weekdays.weekday = timeslots.weekday
	ORDER BY course, classes.title, weekday_sort_key</sql><sql name="Edit View classes_view*">DROP VIEW IF EXISTS &quot;main&quot;.&quot;classes_view&quot;;
CREATE VIEW classes_view as 
SELECT cls.class_id as class_id, co.code as 'course', 
cls.title as 'class', 
r.name as 'where', 
w.sort_key as weekday_sort_key, 
ts.weekday as weekday,
 ts.weekday || ' ' || ts.start_time as 'when', 
 t.name as 'who',
 ts.timeslot_id as timeslot_id,
 ts.active as timeslot_active
 FROM classes cls
	LEFT JOIN courses co USING (course_id)
	LEFT JOIN rooms r USING (room_id)
	LEFT JOIN timeslots ts USING (timeslot_id)
	LEFT JOIN teachers t USING (teacher_id)
	LEFT JOIN weekdays w ON w.weekday = ts.weekday
	ORDER BY course, class, weekday_sort_key</sql><sql name="Edit View classes_view*">PRAGMA table_info(teachers)</sql><sql name="Edit View classes_view*">CREATE VIEW demand_view AS
SELECT
  s.student_id,
  s.email,
  s.firstName,
  s.lastName,
  s.level,
  s.program,
  -- Pivoting choices for Monday
  MAX(CASE WHEN sc.choice = 'IM1' THEN sc.course_code END) AS IM1,
  MAX(CASE WHEN sc.choice = 'IM2' THEN sc.course_code END) AS IM2,
  MAX(CASE WHEN sc.choice = 'IM3' THEN sc.course_code END) AS IM3,
  MAX(CASE WHEN sc.choice = 'Ia1' THEN sc.course_code END) AS Ia1,
  MAX(CASE WHEN sc.choice = 'Ia2' THEN sc.course_code END) AS Ia2,
  MAX(CASE WHEN sc.choice = 'Ia3' THEN sc.course_code END) AS Ia3,
  MAX(CASE WHEN sc.choice = 'Ia4' THEN sc.course_code END) AS Ia4,
  MAX(CASE WHEN sc.choice = 'Ia4' THEN sc.course_code END) AS Ia5,
  MAX(CASE WHEN sc.choice = 'Ga1' THEN sc.course_code END) AS Ga1,
  MAX(CASE WHEN sc.choice = 'Ga2' THEN sc.course_code END) AS Ga2,
  MAX(CASE WHEN sc.choice = 'Ga3' THEN sc.course_code END) AS Ga3,
  MAX(CASE WHEN sc.choice = 'Ga4' THEN sc.course_code END) AS Ga4,
  MAX(CASE WHEN sc.choice = 'Ga5' THEN sc.course_code END) AS Ga5,
  s.active
FROM
  students s
LEFT JOIN
  student_choices sc ON s.student_id = sc.student_id
GROUP BY
  s.student_id</sql><sql name="Edit View demand_view*">DROP VIEW IF EXISTS &quot;main&quot;.&quot;demand_view&quot;;
CREATE VIEW demand_view AS
SELECT
  s.student_id,
  s.email,
  s.firstName,
  s.lastName,
  s.level,
  s.program,
  -- Pivoting choices for Monday
  MAX(CASE WHEN sc.choice = 'IM1' THEN sc.course_code END) AS IM1,
  MAX(CASE WHEN sc.choice = 'IM2' THEN sc.course_code END) AS IM2,
  MAX(CASE WHEN sc.choice = 'IM3' THEN sc.course_code END) AS IM3,
  MAX(CASE WHEN sc.choice = 'Ia1' THEN sc.course_code END) AS Ia1,
  MAX(CASE WHEN sc.choice = 'Ia2' THEN sc.course_code END) AS Ia2,
  MAX(CASE WHEN sc.choice = 'Ia3' THEN sc.course_code END) AS Ia3,
  MAX(CASE WHEN sc.choice = 'Ia4' THEN sc.course_code END) AS Ia4,
  MAX(CASE WHEN sc.choice = 'Ia5' THEN sc.course_code END) AS Ia5,
  MAX(CASE WHEN sc.choice = 'Ga1' THEN sc.course_code END) AS Ga1,
  MAX(CASE WHEN sc.choice = 'Ga2' THEN sc.course_code END) AS Ga2,
  MAX(CASE WHEN sc.choice = 'Ga3' THEN sc.course_code END) AS Ga3,
  MAX(CASE WHEN sc.choice = 'Ga4' THEN sc.course_code END) AS Ga4,
  MAX(CASE WHEN sc.choice = 'Ga5' THEN sc.course_code END) AS Ga5,
  s.active
FROM
  students s
LEFT JOIN
  student_choices sc ON s.student_id = sc.student_id
GROUP BY
  s.student_id</sql><sql name="Edit View demand_view*">
SELECT cls.class_id as class_id, co.code as 'course', 
cls.title as 'title', 
cls.for_program as for_program,
r.name as 'where', 
			CASE 
				WHEN ts.weekday = 'Mon' THEN 1
				WHEN ts.weekday = 'Tue' THEN 2
				WHEN ts.weekday = 'Wed' THEN 3
				WHEN ts.weekday = 'Thu' THEN 4
				WHEN ts.weekday = 'Fri' THEN 5
				WHEN ts.weekday = 'Sat' THEN 6
				WHEN ts.weekday = 'Sun' THEN 7
			END AS weekday_sort_key,
ts.weekday as weekday,
 ts.weekday || ' ' || ts.start_time as 'when', 
 t.name as 'who',
 ts.timeslot_id as timeslot_id,
 ts.active as timeslot_active
 FROM classes cls
	LEFT JOIN courses co USING (course_id)
	LEFT JOIN rooms r USING (room_id)
	LEFT JOIN timeslots ts USING (timeslot_id)
	LEFT JOIN teachers t USING (teacher_id)
	ORDER BY course, title, weekday_sort_key</sql><sql name="Edit View classes_view*">DROP VIEW IF EXISTS &quot;main&quot;.&quot;classes_view&quot;;
CREATE VIEW classes_view as 

SELECT cls.class_id as class_id, co.code as 'course', 
cls.title as 'title', 
cls.for_program as for_program,
r.name as 'where', 
			CASE 
				WHEN ts.weekday = 'Mon' THEN 1
				WHEN ts.weekday = 'Tue' THEN 2
				WHEN ts.weekday = 'Wed' THEN 3
				WHEN ts.weekday = 'Thu' THEN 4
				WHEN ts.weekday = 'Fri' THEN 5
				WHEN ts.weekday = 'Sat' THEN 6
				WHEN ts.weekday = 'Sun' THEN 7
			END AS weekday_sort_key,
ts.weekday as weekday,
 ts.weekday || ' ' || ts.start_time as 'when', 
 t.name as 'who',
 ts.timeslot_id as timeslot_id,
 ts.active as timeslot_active
 FROM classes cls
	LEFT JOIN courses co USING (course_id)
	LEFT JOIN rooms r USING (room_id)
	LEFT JOIN timeslots ts USING (timeslot_id)
	LEFT JOIN teachers t USING (teacher_id)
	ORDER BY course, title, weekday_sort_key</sql><current_tab id="7"/></tab_sql></sqlb_project>
